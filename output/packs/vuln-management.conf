{
  "queries": {
    "apt_sources": {
      "description": "Retrieves all the APT sources to install packages from in the target Linux system.",
      "interval": "86400",
      "platform": "linux",
      "query": "select * from apt_sources;",
      "value": "In the future this may not have a lot of value as we expect to have installed only signed packages",
      "version": "1.4.5"
    },
    "backdoored_python_packages": {
      "description": "Watches for the backdoored Python packages installed on system. See (http://www.nbu.gov.sk/skcsirt-sa-20170909-pypi/index.html)",
      "interval": "86400",
      "platform": "posix",
      "query": "select name as package_name, version as package_version, path as package_path from python_packages where package_name = 'acqusition' or package_name = 'apidev-coop' or package_name = 'bzip' or package_name = 'crypt' or package_name = 'django-server' or package_name = 'pwd' or package_name = 'setup-tools' or package_name = 'telnet' or package_name = 'urlib3' or package_name = 'urllib';",
      "value": "Gives some assurances that no bad Python packages are installed on the system.",
      "version": "1.4.5"
    },
    "browser_plugins": {
      "description": "Retrieves the list of C/NPAPI browser plugins in the target system.",
      "interval": "86400",
      "platform": "darwin",
      "query": "select browser_plugins.* from users join browser_plugins using (uid);",
      "value": "General security posture.",
      "version": "1.6.1"
    },
    "chrome_extensions": {
      "description": "Retrieves the list of extensions for Chrome in the target system.",
      "interval": "86400",
      "query": "select chrome_extensions.* from users join chrome_extensions using (uid);",
      "value": "General security posture.",
      "version": "1.6.1"
    },
    "deb_packages": {
      "description": "Retrieves all the installed DEB packages in the target Linux system.",
      "interval": "86400",
      "platform": "linux",
      "query": "select * from deb_packages;",
      "value": "This, with the help of vulnerability feed, can help tell if a vulnerable application is installed.",
      "version": "1.4.5"
    },
    "firefox_addons": {
      "description": "Retrieves the list of addons for Firefox in the target system.",
      "interval": "86400",
      "platform": "posix",
      "query": "select firefox_addons.* from users join firefox_addons using (uid);",
      "value": "General security posture.",
      "version": "1.6.1"
    },
    "homebrew_packages": {
      "description": "Retrieves the list of brew packages installed in the target OSX system.",
      "interval": "86400",
      "platform": "darwin",
      "query": "select * from homebrew_packages;",
      "value": "This, with the help of a vulnerability feed, can help tell if a vulnerable application is installed.",
      "version": "1.4.5"
    },
    "installed_applications": {
      "description": "Retrieves all the currently installed applications in the target OSX system.",
      "interval": "86400",
      "platform": "darwin",
      "query": "select * from apps;",
      "value": "This, with the help of a vulnerability feed, can help tell if a vulnerable application is installed.",
      "version": "1.4.5"
    },
    "kernel_info": {
      "description": "Retrieves information from the current kernel in the target system.",
      "interval": "86400",
      "query": "select * from kernel_info;",
      "value": "Kernel version can tell you vulnerabilities based on the version",
      "version": "1.4.5"
    },
    "kernel_modules": {
      "description": "Retrieves all the information for the current kernel modules in the target Linux system.",
      "interval": "86400",
      "platform": "linux",
      "query": "select * from kernel_modules;",
      "value": "Only for Linux.  It may pinpoint inserted modules that can carry malicious payloads.",
      "version": "1.4.5"
    },
    "kextstat": {
      "description": "Retrieves all the information about the current kernel extensions for the target OSX system.",
      "interval": "86400",
      "platform": "darwin",
      "query": "select * from kernel_extensions;",
      "value": "Only for OS X.  It may pinpoint inserted modules that can carry malicious payloads.",
      "version": "1.4.5"
    },
    "opera_extensions": {
      "description": "Retrieves the list of extensions for Opera in the target system.",
      "interval": "86400",
      "platform": "posix",
      "query": "select opera_extensions.* from users join opera_extensions using (uid);",
      "value": "General security posture.",
      "version": "1.6.1"
    },
    "os_version": {
      "description": "Retrieves the current version of the running osquery in the target system and where the configuration was loaded from.",
      "interval": "86400",
      "query": "select * from os_version;",
      "value": "OS version will tell which distribution the OS is running on, allowing to detect the main distribution",
      "version": "1.4.5"
    },
    "package_receipts": {
      "description": "Retrieves all the PKG related information stored in OSX.",
      "interval": "86400",
      "platform": "darwin",
      "query": "select * from package_receipts;",
      "value": "It could give you a trail of installed/deleted packages",
      "version": "1.4.5"
    },
    "portage_packages": {
      "description": "Retrieves all the installed packages on the target Linux system.",
      "interval": "86400",
      "platform": "linux",
      "query": "select * from portage_packages;",
      "value": "This, with the help of vulnerability feed, can help tell if a vulnerable application is installed.",
      "version": "2.0.0"
    },
    "rpm_packages": {
      "description": "Retrieves all the installed RPM packages in the target Linux system.",
      "interval": "86400",
      "platform": "linux",
      "query": "select * from rpm_packages;",
      "value": "This, with the help of vulnerability feed, can help tell if a vulnerable application is installed.",
      "version": "1.4.5"
    },
    "safari_extensions": {
      "description": "Retrieves the list of extensions for Safari in the target system.",
      "interval": "86400",
      "platform": "darwin",
      "query": "select safari_extensions.* from users join safari_extensions using (uid);",
      "value": "General security posture.",
      "version": "1.6.1"
    },
    "unauthenticated_sparkle_feeds": {
      "description": "Retrieves all application bundles using unauthenticated Sparkle update feeds. See (https://vulnsec.com/2016/osx-apps-vulnerabilities/) for details.",
      "interval": "86400",
      "platform": "darwin",
      "query": "select feeds.*, p2.value as sparkle_version from (select a.name as app_name, a.path as app_path, a.bundle_identifier as bundle_id, p.value as feed_url from (select name, path, bundle_identifier from apps) a, plist p where p.path = a.path || '/Contents/Info.plist' and p.key = 'SUFeedURL' and feed_url like 'http://%') feeds left outer join plist p2 on p2.path = app_path || '/Contents/Frameworks/Sparkle.framework/Resources/Info.plist' where (p2.key = 'CFBundleShortVersionString' OR coalesce(p2.key, '') = '');",
      "value": "Tracking vulnerable applications updates may allow blocking of DNS or removal by BundleID.",
      "version": "1.4.5"
    }
  }
}
